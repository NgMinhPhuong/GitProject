<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    td{
        text-align: center;
        cursor: pointer;
        color: blue;
    }
   
</style>
<body>
    <button onclick="display()">Start</button>
    <div></div>
    <script>
        function display()
        {
            let size = Number(prompt('Chọn kích cỡ bạn muốn (n*n)'))
            let cnt = 0;
            let res = "<table border = '1' style='width: 100%;height:600px; border-color: #0000ff'>";
            for(let i = 0; i < size; i++)
            {   
                res += '<tr>'
                for(let j = 0; j < size; j++)
                {
                if(i == 0 ){                  
                        res += `<td style="color: black" id='999991' class='${cnt}'>...</td>`
                        cnt++;
                    }else if(i == size - 1)
                    {
                        res += `<td style="color: black" id='999993' class='${cnt}'>...</td>`
                        cnt++;
                    }
                    else if(j == 0){
                        res += `<td style="color: black" id='999994' class='${cnt}'>...</td>`
                        cnt++;
                    }
                    else if(j == size - 1){
                        res += `<td style="color: black" id='999992' class='${cnt}'>...</td>`
                        cnt++;
                    }
                    else{
                        res += `<td style="color: black" id="${i*10+j}" class='${cnt}'>...</td>`
                        cnt++;
                    }
                }
                res += '</tr>';
            }
            document.querySelector('div').innerHTML = res;
        
            var check = 0;
        
            var allTD = document.querySelectorAll('td');
            console.log(allTD);
            function checkWin(Thea){
                for(let i = 0; i < 3; i++)
                {   ///Kiểm tra X có win ko 
                        let inn;  
                        let limitTop = +Thea.getAttribute('class');
                        let limitBottom = +Thea.getAttribute('class');
                        let q = 4;
                        while(q--)
                        {
                            if(i == 0){
                                if(allTD[limitTop].id == '999991' || allTD[limitTop].id == '999994'){
    
                                    limitTop = +allTD[limitTop].getAttribute('class'); break;
                                }
                                limitTop -= (size + 1); 
                                inn = (size + 1);
                            } 
                            else if(i == 1){
                                if(allTD[limitTop].id == '999991'){
                                    limitTop = +allTD[limitTop].getAttribute('class'); break;
                                }
                                limitTop -= size;
                                inn = size;
                            }  
                            else{
                                if(allTD[limitTop].id == '999991' || allTD[limitTop].id == '999992'){
    
                                    limitTop = +allTD[limitTop].getAttribute('class'); break;
                                }
                                limitTop -= (size - 1);
                                inn = (size - 1);
                            }      
                        }
                        q = 4;
                  //----------------------      
                        while(q--){
                            if(i == 0)
                            {
                                if(allTD[limitBottom].id == '999992' || allTD[limitBottom].id == '999993'){
                                    limitBottom = +allTD[limitBottom].getAttribute('class'); break;
                                }
                                limitBottom += (size + 1);
                            }
                            else if( i == 1)
                            {
                                if(allTD[limitBottom].id == '999993'){
                                    limitBottom = +allTD[limitBottom].getAttribute('class'); break;
                                }
                                limitBottom += size;
                            }
                            else{
                                if(allTD[limitBottom].id == '999993' || allTD[limitBottom].id == '999994'){
                                    limitBottom = +allTD[limitBottom].getAttribute('class'); break;
                                }
                                limitBottom += (size - 1);
                            }
                        }                      
                    //---------------------------Kiểm tra chiến thắng
                        for(let j = limitTop; j <= limitBottom; j+=inn){
                            let dem = 0;
                            for(let k = j; k <= j+(inn*4); k+=inn){
                                if(k > limitBottom) break;
                                if(allTD[k].innerText == Thea.innerText) dem++;
                            }
                            let ch;
                            if(Thea.innerText == 'X') ch = 'O';
                            else ch = 'X'
                            if(dem == 5) alert(`${Thea.innerText} thắng rồi con gà ${ch}`);
                        }   
                } 
            }
            for(let i = 0; i < size*size; i++)
            {
                allTD[i].onclick = function(e){
                if(check % 2 == 0) {//Kiểm tra đánh trùng
                    if(this.innerText == '...')
                    {
                        this.innerText = 'X';
                        check++;
                    }
                }
                else {
                    if(this.innerText =='...')
                    {
                        this.innerText = 'O';
                        this.style.color = 'red';
                        check++;
                    }
                }
                checkWin(this);
                }       
            }
        }
    </script>
</body>
</html>